## 출근시간 타켓 마케팅의 인과적 효과 분석 사례

처음에 데이터를 시작했을 때부터 관심있던 분야가 있었습니다. 바로 ‘의사결정’에 대한 부분인데, 좋은 기회에 PAP를 통해 인과추론에 대한 스터디를 진행하였습니다. 
[인과추론의 데이터과학](https://www.youtube.com/channel/UCkEHnPq2T8Vpafk3p-Rk49A) 유튜브 채널을 통해 공부를 하였는데, 인상 깊게 봤던 연구 사례를 정리해 공유드립니다. 
인과추론에는 크게 두 가지 접근방식: **Design-based approach**와 **structure-based approach**가 있습니다. 오늘 가져온 사례는 design-based approach를 활용하였는데, 이 방식은 연구 설계를 적절하게 고안함으로써 인과추론에 방해가 되는 요인을 최대한 제거하는 것이 목표입니다. 
오늘 얘기할 스터디는 design-based approach, 즉
위 시리즈에서 얘기하는 인과추론의 핵심은 결국 

Design-based approach에서는 실험을 얼마나 잘 디자인 하였는지가 인과 추론의 퀄리티를 결정하는 요인입니다. 그래서 결과나 수식 보다는 실험을 어떻게 설계하였는지 간략하게 이해할 수 있는 글이었으면 좋겠습니다.

### 연구 배경

본 사례는 모바일 쿠폰(기프티콘 등)의 문맥 타게팅에 대해 2015년에 진행한 실험으로 2019년에 작성된 연구입니다. 대중화 된 스마트폰에 비해 모바일 쿠폰 사용율(실물로 교환하는 비율)은 너무 낮다는 것에 대한 문제제기로 시작되었습니다. 그 이유는 단순히 매개체만 종이에서 바뀌었을 뿐 모바일로 바뀌었지만 스마트폰의 다영한 특징을 살리지 못하고 있기 때문이라고 판단했습니다.

여기서 말하는 스마트폰의 중요한 특징은 아래와 같습니다.
1. 항상 들고다님: 원하는 시간에 쿠폰 전달 가능(temporal aspect)
2. 위치 정보 습득 가능: 장소를 고려해서 쿠폰 전달 가능(geographical aspect)
위 두 정보를 결합하면 특정 상황을 이용한 문맥(context) 타게팅이 가능합니다. 

오늘 알아볼 context는 바로 **통근**입니다. 사람들은 평균적으로 매일 1시간을 이 context에서 소비하고, 상위 3%는 무려 3시간이나 소비합니다. 그리고 출퇴근하는 사람들 중 89%는 스마트폰을 사용합니다. 모바일 쿠폰에 대한 연구이기 때문에 context에 있는 대상자가 얼마나 스마트폰에 익숙한지는 매우 중요한 지표입니다. 
즉, 본 연구는 "통근이라는 context가 모바일 쿠폰 사용률에 영향을 미치는가?"에 대한 연구입니다. 

지금까지 출퇴근과 연관된 연구 분야는 스트레스였습니다. 기존 연구에 의하면 통근은 만성 스트레스를 유발하고, 만성 스트레스는 생리학적으로 식욕을 증가시키고, 심리학적으로는 충동적인 행위를 야기한다고 합니다. 즉 통근러를 대상으로 모바일 쿠폰을 준다면 반응이 더 좋을 것 같다는 추측에서 실험을 진행하게 되었습니다.

![통근러에게 쿠폰을 뿌리면 교환률이 더 높을 것이라 예상! 세상 모든 통근러 화이팅..ㅜ](img_1.png)

### 실험

실험의 디자인을 간단히 설명하면 모바일 쿠폰을 통근러/비통근러에게 랜덤하게 나누어 준 후, 그 두 그룹간의 실제 교환률을 비교하는 방식입니다.

실험은 길찾기 앱을 이용해 진행되었는데 해당 앱은 집, 회사를 등록해 출퇴근 경로 길찾기 또는 그 외 길찾기가 가능합니다. 그래서 '집으로' 또는 '회사로'를 선택하면 그 사람이 통근이라는 context에 있다는 것이 명확해집니다. 
즉, 본 실험에서 치료군은 '집으로' 또는 '회사로'를 누른 사용자이고, 자연스럽게 대조군은 그 외 길찾기를 한 사용자가 되는 것입니다. 

실험을 위해 5종류로 구성된 총 15,000개 정도의 쿠폰을 10,000명의 사용자에게 랜덤하게 뿌렸습니다. 그래서 사용자에 따라 한개 이상의 쿠폰을 받은 경우도 있습니다.

위의 실험을 통해 총 두 가지 분석을 할 수 있습니다: 
1. 한개의 쿠폰만 받은 사용자: 통근할 때 쿠폰을 받았는지, 또는 그 외 경우에 쿠폰을 받았는지에 따라 쿠폰 사용률을 비교하기 위한 분석
2. 두개 이상의 쿠폰을 받은 사용자: 몇개의 쿠폰을, 기한은 얼마나 주는 것이 효과적인지 보기 위한 분석
(하지만 본 글에서는 1번에 대한 분석만 다루겠습니다.)

실험에서 종속변수는 *쿠폰을 사용했는지 또는 사용하지 않았는지*, 독립변수는 *사용자가 출퇴근 context에서 쿠폰을 받았는지 또는 그 외 context에서 쿠폰을 받았는지*, 그리고 통제변수로는 *쿠폰을 받은 시간, 요일, 어떤 상품, 쿠폰 만료일, 사용자의 앱 사용 빈도* 등이 있습니다.

하지만, 분명 random assignment를 했다고 하더라도 통근러와 비통근러의 특징 떄문에 사용자의 구성, 또는 시간대 등과 같은 디테일이 다를 수 있습니다. 그래서 **propensity score matching**이라는 기법을 통해 치료군과 대조군의 특징을 최대한 맞춰주었습니다.
매칭 변수로는 사용자 구성을 나타내는 (앱의)사용 빈도와 평균 사용량이 있었고, 타케팅 디테일을 나타내는 쿠폰 전달 시간대 및 요일, 상품 종류, 쿠폰 만료일 등이 있었습니다. 

### 결과
한개의 쿠폰만 받은 사용자를 분석한 결과, 가설과 같이 출퇴근 context에 쿠폰을 받은 경우 그렇지 않은 사용자에 비해 쿠폰 사용률이 2~3배 정도로 유의미한 차이가 있다는 것을 확인하였습니다. 
두개 이상의 쿠폰을 받은 사용자를 분석한 결과, 여러장의 쿠폰을 줌으로써 사용률을 높히려는 시도는 통근러보다 그 외 context에 있는 사용자에게 더 효과가 좋은 것을 확인했습니다.
또 출퇴근 context에서는 쿠폰 만료일이 가까웠을 때 사용률이 높고, 그 외 context에서는 반대로 기한이 많이 남았을 때 사용률이 높다는 것을 확인하였습니다. 

![쿠폰을 여러개 주는 것에 대한 효과 분석](img_2.png)


